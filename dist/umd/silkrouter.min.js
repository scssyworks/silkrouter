!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs")):"function"==typeof define&&define.amd?define(["exports","rxjs"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).silkrouter={},t.rxjs)}(this,(function(t,e){"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,i=void 0,"symbol"==typeof(i=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"))?i:String(i)),r)}var o,i}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(){return Object.assign.apply(Object,arguments)}var u="popstate",c=/:[^/]+/g,s=/^\/(?=[^?]*)/,f="Route string is not a pure route",h="vpushstate",l=["route","hashRouting","path","hash","search","hashSearch","data"],p="&",b="?",v="",y=void 0,m=n(v),d=n(!0),g=n(y);n({}),n(0);var w=n((function(){})),_="State",x="push".concat(_),S="replace".concat(_);function O(){return("undefined"==typeof globalThis?"undefined":n(globalThis))!==g?globalThis:global||self}function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}var E=function(t){return"number"==typeof t?t-t==0:"string"==typeof t&&""!==t.trim()&&(Number.isFinite?Number.isFinite(+t):isFinite(+t))},R=function(t){return"object"==typeof t&&null!==t},k=void 0,A=j(k),T=j(""),N=("undefined"==typeof window?"undefined":j(window))!==A?window.location:null,P=Array.isArray;function C(t){return-1===["__proto__","prototype"].indexOf(t)}function I(t){return/\[/.test(t)}function F(){return Object.create(null)}function M(t,e){var n=this;j(t)!==T&&(t=N?N.search:""),t=t.substring("?"===t.charAt(0));var r=F();return t&&t.split("&").forEach((function(t){var o=t.split("=").map((function(t){return decodeURIComponent(t)}));I(o[0])?L.apply(n,[].concat(o).concat([r,e])):U.apply(n,[o,r,!1,e])})),r}function q(t,e){return j(t)===A?e?[]:F():e?t:(n=t,r=F(),P(n)&&n.forEach((function(t,e){r[e]=t})),r);var n,r}function z(t,e){return R(t)&&!P(t)?{ob:t}:P(t)||j(t)===A?{ob:q(t,E(e))}:{ob:[t],push:null!==t}}function L(t,e,n,r){var o=t.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===o.length){var i=o[1],a=o[2];if(I(t=t.replace(/\[([^\[]*)\]/,"")))""===a&&(a="0"),L(t=t.replace(/[^\[]+/,a),e,n[i]=z(n[i],a).ob,r);else if(a){if(C(i)&&C(a)){var u=z(n[i],a),c=u.ob,s=u.push;n[i]=c;var f=s?F():n[i];f[a]=H(e,!r),s&&n[i].push(f)}}else U([o[1],e],n,!0,r)}}function U(t,e,n,r){var o=t[0],i=t[1];C(o)&&(i=H(i,!r),!function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(e,o)?e[o]=n?[i]:i:(e[o]=P(e[o])?e[o]:[e[o]],e[o].push(i)))}function H(t,e){if(null==t)return"";if(e||j(t)!==T)return t;if(t=t.trim(),E(t))return+t;switch(t){case"null":return null;case A:return k;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}var Q=Array.isArray,B=Object.keys;function D(t){return n(t)===m?t.trim():v}function G(t){return s.test(t)}function J(t,e){if(R(t))for(var r=B(t),o=0;o<r.length;o++){var i=r[o],a=e(t[i],E(i)?+i:i);if(n(a)===d&&!a)break}}function K(t,e,r){(t=Array.from(t instanceof Node?[t]:t)).length&&n(e)===m&&J(t,(function(t){var n=new(O().CustomEvent)(e,{bubbles:!0,cancelable:!0,detail:r||[]});t.dispatchEvent(n)}))}var V=i((function t(e,n){r(this,t);var o=e[0],i=e[1],a=e[2],u=a.config,c=u.location,s=u.history;this.route=o.path,this.hashRouting=o.hash,this.routerInstance=a,this.virtualEvent=n||{},this.originalEvent=i||{},this.path=D(c.pathname),this.hash=c.hash,this.search=D(c.search.substring(1)),this.hashSearch=D(c.hash&&c.hash.split(b)[1]);var f=this.originalEvent.state;this.data=f&&f.data||s.state&&s.state.data}));function W(){var t=this;return function(n){return new e.Observable((function(e){var r=n.subscribe({next:function(n){n.detail[2]===t&&e.next(new V(n.detail,n))},error:e.error,complete:e.complete});return function(){r.unsubscribe()}}))}}var X=function(t,e){return D(t?e.hash.substring(1).split(b)[0]:e.pathname)};function Y(t){var n=t.config,r=n.context,o=n.location,i=n.hashRouting;t.popStateSubscription=e.fromEvent(O(),u).subscribe((function(e){var n=X(i,o);n&&K(r,h,[{path:n,hash:i},e,t])})),t.listeners=e.fromEvent(r,h).pipe(W.apply(t)),i&&!o.hash&&t.set("/",!0,!1)}var Z=encodeURIComponent;function $(t,e,r){R(r)?J(r,(function(n,o){$(t,"".concat(e,"[").concat(Q(r)?v:o,"]"),n)})):n(r)!==w&&t.push("".concat(Z(e),"=").concat(Z(r)))}function tt(t){var e=[];return R(t)?(J(t,(function(t,n){$(e,n,t)})),e.join(p)):n(t)===m?t:v}function et(t,e){var n=this.config.location,r=D(n.search&&n.search.substring(1)),o=D(e?n.hash.split(b)[1]:r);return o?tt(a(M(r),M(o),M(t))):t}function nt(t,e,r){var o=!0;n(r)===d&&(o=r);var i=this.config,u=i.preservePath,c=i.hashRouting,s=i.history,l=a({replace:e,exec:o},n(t)===m?{route:t}:t);e=l.replace,o=l.exec;var p=l.route,g=l.queryString,w=l.preserveQuery,_=l.data,O=l.pageTitle,j=void 0===O?null:O,E=p.split(b);if(R(g)&&(g=tt(g)),g=D(g||E[1]),p=D(E[0]),w&&(g=et.apply(this,[g,c])),!G(p))throw new TypeError(f);var k=p;return c&&(p="/#".concat(p),u&&(p="".concat(p.substring(1)))),p="".concat(p).concat(g?"".concat(b+g):v),s[e?S:x]({data:_},j,p),o&&k&&K(this.config.context,h,[{path:k,hash:c},y,this]),this}function rt(t){var n=this,r=this.config,o=r.hashRouting,i=r.location,a=r.init,u=X(o,i);return function(r){return new e.Observable((function(e){var i=r.subscribe(e);return t||(t=!0,a&&u&&e.next(new V([{path:u,hash:o},y,n]))),function(){i.unsubscribe()}}))}}var ot=function(){function t(e){r(this,t);var n=O(),o=n.history,i=n.location,u=n.document;if(!o[x])throw new Error("History unsupported!");this.config=Object.freeze(a({init:!0,hashRouting:!1,preservePath:!1,context:u.body,location:i,history:o},e||{})),this.__paths__=[],Y(this)}return i(t,[{key:"pipe",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.listeners).pipe.apply(t,[rt.apply(this)].concat(n))}},{key:"subscribe",value:function(){var t;return(t=this.pipe()).subscribe.apply(t,arguments)}},{key:"set",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return nt.apply(this,e)}},{key:"destroy",value:function(t){n(t)===w&&t(),this.popStateSubscription.unsubscribe(),this.__paths__.length=0}}]),t}();function it(t,e){var n={};if(c.test(t)){var r=new RegExp(t.replace(/\//g,"\\/").replace(/:[^/\\]+/g,"([^\\/]+)"));if(c.lastIndex=0,r.test(e)){var o=Array.from(t.match(c)).map((function(t){return t.replace(":",v)})),i=Array.from(e.match(r));i.shift(),J(o,(function(t,e){n[t]=i[e]}))}}return n}function at(t,e,n){J(B(t),(function(r){R(t[r])&&R(e[r])?at(t[r],e[r],n):n.break=t[r]!==e[r]}))}var ut=Object.freeze({__proto__:null,route:function(t,r,o){if(n(r)===d&&(o=r,r=y),t=D(t),r instanceof ot){var i=r.__paths__;-1===i.indexOf(t)&&i.push(t)}return function(n){return new e.Observable((function(e){var i=n.subscribe({next:function(n){var r=n.route;if(G(t)){o&&(t=t.toLowerCase(),r=r.toLowerCase());var i=it(t,r),a=B(i).length;(r===t||a>0)&&(a>0&&(n.params=i),e.next(n))}else e.error(new Error(f))},error:e.error,complete:e.complete});return function(){if(r instanceof ot){var e=r.__paths__,n=e.indexOf(t);n>-1&&e.splice(n,1)}i.unsubscribe()}}))}},deparam:function(t){return function(n){return new e.Observable((function(e){var r=n.subscribe({next:function(n){try{n.search=M(n.search,t),n.hashSearch=M(n.hashSearch,t),e.next(n)}catch(t){e.error(t)}},error:e.error,complete:e.complete});return function(){r.unsubscribe()}}))}},noMatch:function(t){return function(n){return new e.Observable((function(e){var r=n.subscribe({next:function(n){if(t instanceof ot){var r=t.__paths__;if(r.length>0){var o=n.route,i=!1;J(r,(function(t){if(t===o||B(it(t,o)).length)return!(i=!0)})),i||(n.noMatch=!0,e.next(n))}}},error:e.error,complete:e.complete});return function(){r.unsubscribe()}}))}},cache:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,r=arguments.length>1?arguments[1]:void 0,o={};return n(t)===d&&(r=t,t=l),function(n){return new e.Observable((function(e){var i=n.subscribe({next:function(n){J(t,(function(t){if(r&&R(n[t])&&R(o[t])){var i={};if(at(n[t],o[t],i),i.break)return a(o,n),e.next(n),!1}else if(n[t]!==o[t])return a(o,n),e.next(n),!1}))},error:e.error,complete:e.complete});return function(){i.unsubscribe(),o={}}}))}}});t.Router=ot,t.operators=ut,Object.defineProperty(t,"__esModule",{value:!0})}));
