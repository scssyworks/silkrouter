{"version":3,"file":"silkrouter.js","sources":["../../src/js/utils/constants.js","../../node_modules/is-number/index.js","../../node_modules/is-object/index.js","../../src/js/utils/utils.js","../../src/js/utils/params.js","../../src/js/utils/assign.js","../../src/js/utils/triggerEvent.js","../../src/js/api/set/index.js","../../src/js/utils/getPath.js","../../src/js/api/routerEvent/index.js","../../src/js/api/collate/index.js","../../src/js/api/callOnce/index.js","../../src/js/api/router/RouterCore.js","../../src/js/api/router/Router.js"],"sourcesContent":["/**\n * Router constants\n */\nexport const POP_STATE = 'popstate';\nexport const REG_ROUTE_PARAMS = /:[^/]+/g;\nexport const REG_PATHNAME = /^\\/(?=[^?]*)/;\nexport const REG_COMPLEX = /\\[/;\nexport const REG_VARIABLE = /([^[]+)\\[([^[]*)\\]/;\nexport const REG_REPLACE_BRACKETS = /\\[([^[]*)\\]/;\nexport const REG_REPLACE_NEXTPROP = /[^[]+/;\nexport const HISTORY_UNSUPPORTED = 'History unsupported!';\nexport const INVALID_ROUTE = 'Route string is not a pure route';\nexport const VIRTUAL_PUSHSTATE = 'vpushstate';\nexport const CACHED_FIELDS = [\n  'route',\n  'data',\n  'query',\n  'params',\n  'index',\n  'ignoreCase',\n  'isHashRoute',\n];\nexport const AMP = '&';\nexport const QRY = '?';\nexport const EQ = '=';\nexport const EMPTY = '';\nexport const UNDEF = void 0;\nexport const TYPEOF_STR = typeof EMPTY;\nexport const TYPEOF_BOOL = typeof true;\nexport const TYPEOF_UNDEF = typeof UNDEF;\nexport const TYPEOF_OBJ = typeof {};\nexport const TYPEOF_NUM = typeof 0;\nexport const TYPEOF_FUNC = typeof (() => {});\nexport const STATE = 'State';\nexport const PUSH = `push${STATE}`;\nexport const REPLACE = `replace${STATE}`;\n","/*!\n * is-number <https://github.com/jonschlinkert/is-number>\n *\n * Copyright (c) 2014-present, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function(num) {\n  if (typeof num === 'number') {\n    return num - num === 0;\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isFinite ? Number.isFinite(+num) : isFinite(+num);\n  }\n  return false;\n};\n","'use strict';\n\nmodule.exports = function isObject(x) {\n\treturn typeof x === 'object' && x !== null;\n};\n","import isNumber from 'is-number';\nimport isObject from 'is-object';\nimport { EMPTY, REG_PATHNAME, TYPEOF_BOOL, TYPEOF_STR } from './constants';\n\n/**\n * Shorthand for Array.isArray\n */\nexport const isArr = Array.isArray;\n\n/**\n * Shorthand for Object.keys\n */\nexport const oKeys = Object.keys;\n\n/**\n * Safely trims string\n * @param {string} str String\n */\nexport function trim(str) {\n  return typeof str === TYPEOF_STR ? str.trim() : EMPTY;\n}\n\n/**\n * Checks if given route is valid\n * @private\n * @param {string} route Route string\n */\nexport function isValidRoute(route) {\n  return REG_PATHNAME.test(route);\n}\n\n/**\n * Checks if key is present in provided object\n * @param {object} ob Object\n * @param {*} key Key\n */\nexport function hasOwn(ob, key) {\n  return Object.prototype.hasOwnProperty.call(ob, key);\n}\n\n/**\n * Loops over an array like object\n * @param {object} arrayObj Array or array like object\n * @param {function} callback Callback function\n */\nexport function each(arrayObj, callback) {\n  if (isObject(arrayObj)) {\n    const keys = oKeys(arrayObj);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const cont = callback(arrayObj[key], isNumber(key) ? +key : key);\n      if (typeof cont === TYPEOF_BOOL) {\n        if (!cont) {\n          break;\n        }\n      }\n    }\n  }\n}\n\n/**\n * Transform a string to lower case\n * @param {string} str String input\n * @returns {string}\n */\nexport function lowerCase(str) {\n  return typeof str === 'string' ? str.toLowerCase() : str;\n}\n","import { EMPTY, REG_ROUTE_PARAMS } from './constants';\nimport { each } from './utils';\n\n/**\n * Parses current path and returns params object\n * @param {string} expr Route expression\n * @param {string} path URL path\n * @returns {{[key: string]: any}}\n */\nexport function resolveParams(expr, path) {\n  const params = {};\n  if (REG_ROUTE_PARAMS.test(expr)) {\n    const pathRegex = new RegExp(\n      expr.replace(/\\//g, '\\\\/').replace(/:[^/\\\\]+/g, '([^\\\\/]+)')\n    );\n    REG_ROUTE_PARAMS.lastIndex = 0;\n    if (pathRegex.test(path)) {\n      const keys = Array.from(expr.match(REG_ROUTE_PARAMS)).map((key) =>\n        key.replace(':', EMPTY)\n      );\n      const values = Array.from(path.match(pathRegex));\n      values.shift();\n      each(keys, (key, index) => {\n        params[key] = values[index];\n      });\n    }\n  }\n  return params;\n}\n","/**\n * Function to extend an object with new and updated properties\n * @private\n * @returns {object}\n */\nexport function assign(...args) {\n  return Object.assign(...args);\n}\n","import { TYPEOF_STR } from './constants';\nimport { each } from './utils';\n\n/**\n * Function to trigger custom event\n * @param {Node|NodeList|HTMLCollection|Node[]} target Target element or list\n * @param {string} eventType Event type\n * @param {any[]} data Data to be passed to handler\n */\nexport function trigger(target, eventType, data) {\n  target = Array.from(target instanceof Node ? [target] : target);\n  if (target.length && typeof eventType === TYPEOF_STR) {\n    each(target, (el) => {\n      const customEvent = new CustomEvent(eventType, {\n        bubbles: true,\n        cancelable: true,\n        detail: data || [],\n      });\n      el.dispatchEvent(customEvent);\n    });\n  }\n}\n","import { trigger } from '../../utils/triggerEvent';\nimport {\n  VIRTUAL_PUSHSTATE,\n  INVALID_ROUTE,\n  UNDEF,\n  EMPTY,\n  QRY,\n  REPLACE,\n  PUSH,\n} from '../../utils/constants';\nimport { isValidRoute, trim } from '../../utils/utils';\n\n/**\n * Sets the current route\n * @private\n * @typedef {import('./types').RouteConfig} RouteConfig\n * @param {string} routeStr Route string\n * @param {RouteConfig} [routeConfig] Route config\n * @returns {void}\n */\nexport default function set(routeStr, routeConfig = {}) {\n  const [route, qs] = routeStr.split(QRY);\n  const {\n    replace = false,\n    preventDefault = false,\n    queryString = qs,\n    data,\n    pageTitle = null,\n  } = routeConfig;\n  const { preservePath, hashRouting: hash, history, context } = this.config;\n  // Resolve to URL query string if it's not explicitly passed\n  routeStr = trim(route);\n  if (isValidRoute(routeStr)) {\n    const path = routeStr;\n    if (hash) {\n      routeStr = `${preservePath ? '' : '/'}#${routeStr}`;\n    }\n    // Append query string\n    routeStr = `${routeStr}${trim(\n      queryString ? `${QRY + queryString}` : EMPTY\n    )}`;\n    const savedState = history.state || { idx: 0 };\n    history[replace ? REPLACE : PUSH](\n      {\n        data,\n        idx: savedState.idx + 1,\n      },\n      pageTitle,\n      routeStr\n    );\n    if (!preventDefault && path) {\n      trigger(context, VIRTUAL_PUSHSTATE, [\n        {\n          path,\n          hash,\n        },\n        UNDEF,\n        this,\n      ]);\n    }\n  } else {\n    throw new TypeError(INVALID_ROUTE);\n  }\n}\n","import { QRY } from './constants';\nimport { trim } from './utils';\n\nexport const getPath = (isHash, location) => {\n  return trim(\n    isHash ? location.hash.substring(1).split(QRY)[0] : location.pathname\n  );\n};\n","import { QRY } from '../../utils/constants';\nimport { trim } from '../../utils/utils';\n\n/**\n * Creates an instance of router event\n */\nexport default class RouterEvent {\n  constructor(routeInfo, currentEvent) {\n    // Set relevant parameters\n    const [routeObject, originalEvent, routerInstance] = routeInfo;\n    const { location, history } = routerInstance.config;\n    this.route = routeObject.path;\n    this.isHashRoute = routeObject.hash;\n    this.router = routerInstance;\n    this.currentEvent = originalEvent || currentEvent;\n    this.query = {\n      path: trim(location.search.substring(1)),\n      hash: trim(location.hash.split(QRY)[1]),\n    };\n    const { state } = originalEvent || {};\n    const { data, idx = 0 } = state || history.state || {};\n    this.data = data;\n    this.index = idx;\n  }\n}\n","import { Observable } from 'rxjs';\nimport RouterEvent from '../routerEvent';\n\nexport default function collate() {\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe({\n        next: (event) => {\n          const routerInstance = event.detail[2];\n          if (routerInstance === this) {\n            subscriber.next(new RouterEvent(event.detail, event));\n          }\n        },\n        error: subscriber.error,\n        complete: subscriber.complete,\n      });\n      return () => {\n        subn.unsubscribe();\n      };\n    });\n}\n","import { Observable } from 'rxjs';\nimport { UNDEF } from '../../utils/constants';\nimport { getPath } from '../../utils/getPath';\nimport RouterEvent from '../routerEvent';\n\nexport default function callOnce(isDone) {\n  const { hashRouting: hash, location, init } = this.config;\n  const path = getPath(hash, location);\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe(subscriber);\n      if (!isDone) {\n        isDone = true;\n        if (init && path) {\n          subscriber.next(new RouterEvent([{ path, hash }, UNDEF, this]));\n        }\n      }\n      return () => {\n        subn.unsubscribe();\n      };\n    });\n}\n","import { fromEvent } from 'rxjs';\nimport {\n  HISTORY_UNSUPPORTED,\n  POP_STATE,\n  PUSH,\n  TYPEOF_FUNC,\n  TYPEOF_UNDEF,\n  VIRTUAL_PUSHSTATE,\n} from '../../utils/constants';\nimport { getPath } from '../../utils/getPath';\nimport { trigger } from '../../utils/triggerEvent';\nimport collate from '../collate';\nimport callOnce from '../callOnce';\n\n/**\n * Core router class to handle basic routing functionality\n */\nexport class RouterCore {\n  get global() {\n    return typeof globalThis !== TYPEOF_UNDEF ? globalThis : global || self;\n  }\n  /**\n   * Router core constructor\n   * @typedef {import('./types').RouterCoreConfig} RouterCoreConfig\n   * @param {RouterCoreConfig} routerCoreConfig Route core configuration\n   */\n  constructor({ history, context, location, hash }) {\n    if (!history[PUSH]) {\n      throw new Error(HISTORY_UNSUPPORTED);\n    }\n    this.__paths__ = [];\n    this.popStateSubscription = fromEvent(this.global, POP_STATE).subscribe(\n      (e) => {\n        const path = getPath(hash, location);\n        if (path) {\n          trigger(context, VIRTUAL_PUSHSTATE, [{ path, hash }, e, this]);\n        }\n      }\n    );\n    this.listeners = fromEvent(context, VIRTUAL_PUSHSTATE).pipe(\n      collate.apply(this)\n    );\n  }\n  pipe(...ops) {\n    return this.listeners.pipe(callOnce.apply(this), ...ops);\n  }\n  subscribe(...fns) {\n    return this.pipe().subscribe(...fns);\n  }\n  /**\n   * Destroys current router instance\n   * @param {() => void} callback Callback for destroy function\n   */\n  destroy(callback) {\n    if (typeof callback === TYPEOF_FUNC) {\n      callback();\n    }\n    this.popStateSubscription.unsubscribe(); // Unsubscribe popstate event\n    this.__paths__.length = 0;\n  }\n}\n","import { assign } from '../../utils/assign';\nimport set from '../set';\nimport { RouterCore } from './RouterCore';\n\n/**\n * Browser router to handle routing logic\n */\nexport class Router extends RouterCore {\n  /**\n   * Router constructor\n   * @typedef {import('./types').RouterConfig} RouterConfig\n   * @param {RouterConfig} config\n   */\n  constructor(config = {}) {\n    const { history, location, document } = this.global;\n    const context = document.body;\n    super({\n      history,\n      location,\n      context,\n      hash: config.hashRouting,\n    });\n    this.config = Object.freeze(\n      assign({ init: true, hashRouting: false, preservePath: false }, config, {\n        context,\n        history,\n        location,\n      })\n    );\n    if (config.hashRouting && !location.hash) {\n      this.set('/', {\n        replace: true,\n        preventDefault: true, // Don't execute route handlers\n      });\n    }\n  }\n  /**\n   * Sets the current route path\n   * @typedef {import('../set/types').RouteConfig} RouteConfig\n   * @param {string} path Route path\n   * @param {RouteConfig} routeConfig Route config\n   */\n  set(path, routeConfig) {\n    set.apply(this, [path, routeConfig]);\n  }\n}\n"],"names":["POP_STATE","REG_ROUTE_PARAMS","REG_PATHNAME","HISTORY_UNSUPPORTED","INVALID_ROUTE","VIRTUAL_PUSHSTATE","QRY","EMPTY","UNDEF","TYPEOF_STR","TYPEOF_BOOL","TYPEOF_UNDEF","TYPEOF_FUNC","STATE","PUSH","REPLACE","oKeys","Object","keys","trim","str","isValidRoute","route","test","each","arrayObj","callback","isObject","i","length","key","cont","isNumber","resolveParams","expr","path","params","pathRegex","RegExp","replace","lastIndex","Array","from","match","map","values","shift","index","assign","arguments","trigger","target","eventType","data","Node","el","customEvent","CustomEvent","bubbles","cancelable","detail","dispatchEvent","set","routeStr","routeConfig","undefined","qs","split","preventDefault","queryString","pageTitle","preservePath","hashRouting","hash","history","context","config","savedState","state","idx","TypeError","getPath","isHash","location","substring","pathname","RouterEvent","constructor","routeInfo","currentEvent","routeObject","originalEvent","routerInstance","isHashRoute","router","query","search","collate","observable","Observable","subscriber","subn","subscribe","next","event","error","complete","unsubscribe","callOnce","isDone","init","RouterCore","global","globalThis","self","_ref","Error","__paths__","popStateSubscription","fromEvent","e","listeners","pipe","apply","_len","ops","_key","destroy","Router","document","body","freeze"],"mappings":"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"}