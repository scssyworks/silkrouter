/**!
 * Router plugin for single page applications with routes
 * Released under MIT license
 * @name Silk router
 * @author Sachin Singh <contactsachinsingh@gmail.com>
 * @version 3.5.9
 * @license MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).silkrouter={})}(this,(function(t){"use strict";var n="hashchange",e="popstate",a="route.changed",o=/:[^\/]+/g,r=/^\/(?=[^?]*)/,c=/\?.+/,i="$$",u=["localhost","0.0.0.0","127.0.0.1",null];function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}var f=Array.isArray;function l(t){return"string"==typeof t?t.trim():""}function h(t){return t=l("".concat(t)),!(["null","undefined",""].indexOf(t)>-1)&&!isNaN(+t)}function p(t){return t&&"object"===s(t)}function d(t){return p(t)&&!f(t)}function v(t,n){return void 0===t?n:t}function _(t){return Array.prototype.slice.call(t)}function x(t){return"string"==typeof t&&r.test(t)}function y(t){return"string"==typeof t&&"#"===t.charAt(0)}function g(t){return"function"==typeof t}function m(t,n){return{type:t,state:{data:n}}}function w(t){return t?Object.keys(t):[]}function b(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var S=window.location,C=String.fromCharCode;function E(t,n){n=v(n,S.pathname);var e={};if(o.test(t)){var a=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(o.lastIndex=0,a.test(n)){var r=_(t.match(o)).map((function(t){return t.replace(":","")})),c=_(n.match(a));c.shift(),r.forEach((function(t,n){e[t]=c[n]}))}}return e}function I(t,n,e){p(e)?w(e).forEach((function(a){I(t,"".concat(n,"[").concat(f(e)?"":a,"]"),e[a])})):"function"!=typeof e&&t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e)))}function O(t){var n=[];return p(t)?(w(t).forEach((function(e){I(n,e,t[e])})),n.join("&")):"string"==typeof t?t:""}function A(t){return/\[/.test(t)}function M(t,n){var e=this;"?"===(t=l(v(t,S.search))).charAt(0)&&(t=t.replace("?",""));var a={};return t&&t.split("&").forEach((function(t){var o=t.split("=").map((function(t){return decodeURIComponent(t)}));(A(o[0])?N:j).apply(e,[].concat(o,[a,v(n,!1),!1]))})),a}function T(t,n){return n?void 0===t?[]:t:(a={},f(e=t)&&e.forEach((function(t,n){a[n]=t})),a);var e,a}function k(t,n){return d(t)?{ob:t}:f(t)||void 0===t?{ob:T(t,h(n))}:{ob:[t],push:null!==t}}function N(t,n,e,a){a=v(a,!0);var o=t.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===o.length){var r=o[1],c=o[2];if(A(t=t.replace(/\[([^\[]*)\]/,"")))""===c&&(c="0"),N(t=t.replace(/[^\[]+/,c),n,e[r]=k(e[r],c).ob,a);else if(c){var i=k(e[r],c);e[r]=i.ob;var u=a?D(n):n;if(i.push){var s={};s[c]=u,e[r].push(s)}else e[r][c]=u}else j(r,n,e,a,!0)}}function j(t,n,e,a,o){v(a,!0)&&(n=D(n)),t in e?(e[t]=f(e[t])?e[t]:[e[t]],e[t].push(n)):e[t]=o?[n]:n}function D(t){if(null==t)return"";if("string"!=typeof t)return t;if(h(t=l(t)))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function B(){return M.apply(this,arguments)}function R(t,n){p(t)&&w(t).forEach((function(e){n[e]=t[e]}))}function L(){for(var t=p(arguments[0])?arguments[0]:{},n=1;n<arguments.length;n++)R(arguments[n],t);return t}function P(t,n,e){t.context_data_position==n-1?(t.context_data_position=0,t.context_data.push(e(t.context_data_val)),t.context_data_val=0):t.context_data_position++}function U(t){t.context_enlargeIn--,0==t.context_enlargeIn&&(t.context_enlargeIn=Math.pow(2,t.context_numBits),t.context_numBits++)}function q(t,n,e){if(b(t.context_dictionaryToCreate,t.context_w)){if(t.context_w.charCodeAt(0)<256){for(var a=0;a<t.context_numBits;a++)t.context_data_val=t.context_data_val<<1,P(t,n,e);t.value=t.context_w.charCodeAt(0);for(var o=0;o<8;o++)t.context_data_val=t.context_data_val<<1|1&t.value,P(t,n,e),t.value=t.value>>1}else{t.value=1;for(var r=0;r<t.context_numBits;r++)t.context_data_val=t.context_data_val<<1|t.value,P(t,n,e),t.value=0;t.value=t.context_w.charCodeAt(0);for(var c=0;c<16;c++)t.context_data_val=t.context_data_val<<1|1&t.value,P(t,n,e),t.value=t.value>>1}U(t),delete t.context_dictionaryToCreate[t.context_w]}else{t.value=t.context_dictionary[t.context_w];for(var i=0;i<t.context_numBits;i++)t.context_data_val=t.context_data_val<<1|1&t.value,P(t,n,e),t.value=t.value>>1}U(t)}function z(t,n,e,a){for(var o=0,r=1;r!==n;){var c=t.val&t.position;t.position>>=1,0===t.position&&(t.position=e,t.val=a(t.index++)),o|=(c>0?1:0)*r,r<<=1}return o}function H(t){return null==t?"":function(t,n,e){if(null==t)return"";for(var a={context_dictionary:{},context_dictionaryToCreate:{},context_data:[],context_c:"",context_wc:"",context_w:"",context_enlargeIn:2,context_dictSize:3,context_numBits:2,context_data_val:0,context_data_position:0},o=0,r=0;r<t.length;r+=1)a.context_c=t.charAt(r),b(a.context_dictionary,a.context_c)||(a.context_dictionary[a.context_c]=a.context_dictSize++,a.context_dictionaryToCreate[a.context_c]=!0),a.context_wc=a.context_w+a.context_c,b(a.context_dictionary,a.context_wc)?a.context_w=a.context_wc:(q(a,n,e),a.context_dictionary[a.context_wc]=a.context_dictSize++,a.context_w=String(a.context_c));for(""!==a.context_w&&q(a,n,e),a.value=2,o=0;o<a.context_numBits;o++)a.context_data_val=a.context_data_val<<1|1&a.value,P(a,n,e),a.value=a.value>>1;for(;;){if(a.context_data_val=a.context_data_val<<1,a.context_data_position==n-1){a.context_data.push(e(a.context_data_val));break}a.context_data_position++}return a.context_data.join("")}(t,15,(function(t){return C(t+32)}))+" "}function J(t){return null==t?"":""===t?null:function(t,n,e){for(var a,o,r=[],c={val:e(0),position:n,index:1},i=[],u=4,s=4,f=3,l="",h=0;h<3;h++)r[h]=h;switch(z(c,Math.pow(2,2),n,e)){case 0:o=C(z(c,Math.pow(2,8),n,e));break;case 1:o=C(z(c,Math.pow(2,16),n,e));break;case 2:return""}for(r[3]=o,a=o,i.push(o);;){if(c.index>t)return"";switch(o=z(c,Math.pow(2,f),n,e)){case 0:r[s++]=C(z(c,Math.pow(2,8),n,e)),o=s-1,u--;break;case 1:r[s++]=C(z(c,Math.pow(2,16),n,e)),o=s-1,u--;break;case 2:return i.join("")}if(0===u&&(u=Math.pow(2,f),f++),r[o])l=r[o];else{if(o!==s)return null;l=a+a.charAt(0)}i.push(l),r[s++]=a+l.charAt(0),a=l,0==--u&&(u=Math.pow(2,f),f++)}}(t.length,16384,(function(n){return t.charCodeAt(n)-32}))}function F(){try{return sessionStorage.setItem("testKey","testValue"),sessionStorage.removeItem("testKey"),!0}catch(t){return!1}}function K(t,n){return F()?sessionStorage.setItem(t,H(p(n)?JSON.stringify(n):n)):function(t,n){if(t&&void 0!==n){var e=S.hostname,a="https:"===S.protocol,o=n;p(n)&&(o=JSON.stringify(n));var r=-1===u.indexOf(e)?"; domain=".concat(l(e)):"",c=a?"; secure":"";document.cookie="".concat(t," = ").concat(o).concat(r).concat("; path=/").concat(c)}}(t,n)}function $(t){if(F()){var n=J(sessionStorage.getItem(t));try{return n=JSON.parse(n)}catch(t){return n}}return function(t){if(t){var n=decodeURIComponent(document.cookie),e="";return function(t,n){if(t&&t.length)for(var e=0;e<t.length;e+=1)if("function"==typeof n){var a=n.apply(t,[t[e],e]);if("boolean"==typeof a){if(a)continue;break}}}(n.split(";"),(function(n){var a="".concat(t,"="),o=n.indexOf(a);if(o>-1)return e=l(n.substring(o+a.length,n.length)),!1})),e}return""}(t)}var Q={set:function(){return K.apply(this,arguments)},get:function(){return $.apply(this,arguments)}};function V(){this.handlers=[]}L(V.prototype,{getDataFromStore:function(t,n){return L(Q.get("routeStore"))["".concat(n?"#":"").concat(t)]},setDataToStore:function(t,n,e){var a=L(Q.get("routeStore"));if(a[t]&&(!e||d(e)&&0===w(e).length))return!1;var o={};return o["".concat(n?"#":"").concat(t)]=e,a=L({},a,o),Q.set("routeStore",a)},contains:function(t){return!!this.handlers.filter(t).length},remove:function(t){this.handlers.splice(this.handlers.indexOf(t),1).length}});var G=new V;function W(){var t=S.hash.match(c);return L({},B(),t?L({},B(t[0])):{})}function X(t,n,e){var a=y(n),o=(n=n.substring(+a)).split("?")[0];w(e=L(e)).length&&G.setDataToStore(o,a,e);var r=E(t,n);return{hasMatch:w(r).length>0||x(n)&&(t===n||"*"===t),data:G.getDataFromStore(o,a),params:r}}function Y(t){t.type=t.hash?n:e;var o=v(t.originalData,{});t.originalEvent=v(t.originalEvent,m(t.type,o)),delete t.originalData,function(t,n,e){e=L(e),G.handlers.forEach((function(a){if(a.eventName===t){var o=S[n.hash?"hash":"pathname"],r=X(a.isCaseInsensitive?a.route.toLowerCase():a.route,a.isCaseInsensitive?o.toLowerCase():o,e);r.hasMatch&&(!a.hash||a.hash&&n.hash)&&a.handler(L({},n,{data:r.data,params:r.params,query:W()}))}}))}(a,t,o)}function Z(t,n,e){var a=L({replaceMode:n,noTrigger:e},"string"==typeof t?{route:t}:t);if("string"==typeof a.route){var o=y(a.route),r=l(a.route).split("?"),c=r[0].substring(+o),i=O(l(r[1])||l(a.queryString));if(!x(c))throw new TypeError("Route string is not a pure route");G.setDataToStore(c,o,a.data);var u=function(t,n,e,a){e=l(e.substring(+("?"===e.charAt(0))));var o=a?S.search:"";return n?"".concat(S.pathname).concat(o,"#").concat(t).concat(e?"?".concat(e):""):"".concat(t).concat(o).concat(e?"".concat(o?"&":"?").concat(e):"")}(c,o,i,a.appendQuery);history[a.replaceMode?"replaceState":"pushState"]({data:a.data},a.title,u),a.noTrigger||Y({route:"".concat(o?"#":"").concat(c),hash:o})}}function tt(t,o,r){var c="string"==typeof t&&0===t.indexOf(i);if(g(t)&&(r=o,o=t,t="*"),f(t))return function(t,n){var e=this;G.contains((function(t){return t.prevHandler===n}))||tt((function(a){g(n)&&t.indexOf("".concat(a.hash?"#":"").concat(a.route.substring(+a.hash)))>-1&&n.apply(e,[a])}),n)}(t,o);var u=y(t=t.substring(c?i.length:0));t=t.substring(+u),!G.contains((function(n){return n.handler===o&&n.route===t}))&&g(o)&&G.handlers.push({eventName:a,handler:o,prevHandler:r,route:t,hash:u,isCaseInsensitive:c}),(u?[S.hash]:[S.pathname,S.hash]).filter((function(t){return l(t)})).forEach((function(a){var r=y(a),i=X(c?t.toLowerCase():t,c?a.toLowerCase():a);if(i.hasMatch&&g(o)){var u=r?n:e;o({originalEvent:m(u,i.data),route:a,hash:r,eventName:u,data:i.data,params:i.params,query:W(),isCaseInsensitive:c})}}))}function nt(t,n){var e=G.handlers.length,a=f(t);if(a&&!n)return 0;var o=_(arguments);return 0===o.length?(G.handlers.length=0,e):(t=a?"*":t,G.handlers.forEach((function(e){var r=e.route===t,c=1===o.length;c&&"string"==typeof t&&!a||(c&&g(t)&&(n=t,t="*"),r=r&&(e.handler===n||e.prevHandler===n)),r&&G.remove(e)})),e-G.handlers.length)}function et(t,n){if(n=l(n),!Array.isArray(t))throw new TypeError("Provide a valid list of routes");for(var e=!1,a=0;a<t.length;a++){var o=l(t[a]);if(["*",n].indexOf(o)>-1||Object.keys(E(o,n)).length){e=!0;break}}return e}var at={set:function(){return Z.apply(this,arguments)},includes:function(){return et.apply(this,arguments)},list:function(){var t=[];return G.handlers.forEach((function(n){var e="".concat(n.hash?"#":"").concat(n.route);-1===t.indexOf(e)&&t.push(e)})),t}};function ot(){return tt.apply(this,arguments)}window.addEventListener("".concat(e),(function(t){var n="".concat(S.pathname).concat(S.hash).split("#"),e={originalEvent:t,originalData:L(t.state&&t.state.data)};Y(L({},e,{route:n[0],hash:!1})),n[1]&&Y(L({},e,{route:"#".concat(n[1]),hash:!0}))})),t.deparam=B,t.param=O,t.route=ot,t.routeIgnoreCase=function(t){"string"==typeof t&&ot.apply(this,["".concat(i).concat(t),_(arguments).slice(1)])},t.routeParams=E,t.router=at,t.unroute=function(){return nt.apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0})}));
