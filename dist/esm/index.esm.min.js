/**!
 * Router plugin for single page applications with routes
 * Released under MIT license
 * @name Silk router
 * @author Sachin Singh <contactsachinsingh@gmail.com>
 * @version 3.5.9
 * @license MIT
 */
var t=/:[^\/]+/g,n=/^\/(?=[^?]*)/,e=/\?.+/,a=["localhost","0.0.0.0","127.0.0.1",null];function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var r=Array.isArray;function c(t){return"string"==typeof t?t.trim():""}function i(t){return t=c("".concat(t)),!(["null","undefined",""].indexOf(t)>-1)&&!isNaN(+t)}function u(t){return t&&"object"===o(t)}function s(t){return u(t)&&!r(t)}function f(t,n){return void 0===t?n:t}function l(t){return Array.prototype.slice.call(t)}function h(t){return"string"==typeof t&&n.test(t)}function p(t){return"string"==typeof t&&"#"===t.charAt(0)}function v(t){return"function"==typeof t}function d(t,n){return{type:t,state:{data:n}}}function _(t){return t?Object.keys(t):[]}function x(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var g=window.location,y=String.fromCharCode;function m(n,e){e=f(e,g.pathname);var a={};if(t.test(n)){var o=new RegExp(n.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(t.lastIndex=0,o.test(e)){var r=l(n.match(t)).map((function(t){return t.replace(":","")})),c=l(e.match(o));c.shift(),r.forEach((function(t,n){a[t]=c[n]}))}}return a}function w(t,n,e){u(e)?_(e).forEach((function(a){w(t,"".concat(n,"[").concat(r(e)?"":a,"]"),e[a])})):"function"!=typeof e&&t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e)))}function b(t){var n=[];return u(t)?(_(t).forEach((function(e){w(n,e,t[e])})),n.join("&")):"string"==typeof t?t:""}function S(t){return/\[/.test(t)}function C(t,n){var e=this;"?"===(t=c(f(t,g.search))).charAt(0)&&(t=t.replace("?",""));var a={};return t&&t.split("&").forEach((function(t){var o=t.split("=").map((function(t){return decodeURIComponent(t)}));(S(o[0])?A:O).apply(e,[].concat(o,[a,f(n,!1),!1]))})),a}function E(t,n){return n?void 0===t?[]:t:(a={},r(e=t)&&e.forEach((function(t,n){a[n]=t})),a);var e,a}function I(t,n){return s(t)?{ob:t}:r(t)||void 0===t?{ob:E(t,i(n))}:{ob:[t],push:null!==t}}function A(t,n,e,a){a=f(a,!0);var o=t.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===o.length){var r=o[1],c=o[2];if(S(t=t.replace(/\[([^\[]*)\]/,"")))""===c&&(c="0"),A(t=t.replace(/[^\[]+/,c),n,e[r]=I(e[r],c).ob,a);else if(c){var i=I(e[r],c);e[r]=i.ob;var u=a?M(n):n;if(i.push){var s={};s[c]=u,e[r].push(s)}else e[r][c]=u}else O(r,n,e,a,!0)}}function O(t,n,e,a,o){f(a,!0)&&(n=M(n)),t in e?(e[t]=r(e[t])?e[t]:[e[t]],e[t].push(n)):e[t]=o?[n]:n}function M(t){if(null==t)return"";if("string"!=typeof t)return t;if(i(t=c(t)))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function N(){return C.apply(this,arguments)}function k(t,n){u(t)&&_(t).forEach((function(e){n[e]=t[e]}))}function T(){for(var t=u(arguments[0])?arguments[0]:{},n=1;n<arguments.length;n++)k(arguments[n],t);return t}function D(t,n,e){t.context_data_position==n-1?(t.context_data_position=0,t.context_data.push(e(t.context_data_val)),t.context_data_val=0):t.context_data_position++}function j(t){t.context_enlargeIn--,0==t.context_enlargeIn&&(t.context_enlargeIn=Math.pow(2,t.context_numBits),t.context_numBits++)}function B(t,n,e){if(x(t.context_dictionaryToCreate,t.context_w)){if(t.context_w.charCodeAt(0)<256){for(var a=0;a<t.context_numBits;a++)t.context_data_val=t.context_data_val<<1,D(t,n,e);t.value=t.context_w.charCodeAt(0);for(var o=0;o<8;o++)t.context_data_val=t.context_data_val<<1|1&t.value,D(t,n,e),t.value=t.value>>1}else{t.value=1;for(var r=0;r<t.context_numBits;r++)t.context_data_val=t.context_data_val<<1|t.value,D(t,n,e),t.value=0;t.value=t.context_w.charCodeAt(0);for(var c=0;c<16;c++)t.context_data_val=t.context_data_val<<1|1&t.value,D(t,n,e),t.value=t.value>>1}j(t),delete t.context_dictionaryToCreate[t.context_w]}else{t.value=t.context_dictionary[t.context_w];for(var i=0;i<t.context_numBits;i++)t.context_data_val=t.context_data_val<<1|1&t.value,D(t,n,e),t.value=t.value>>1}j(t)}function R(t,n,e,a){for(var o=0,r=1;r!==n;){var c=t.val&t.position;t.position>>=1,0===t.position&&(t.position=e,t.val=a(t.index++)),o|=(c>0?1:0)*r,r<<=1}return o}function $(t){return null==t?"":function(t,n,e){if(null==t)return"";for(var a={context_dictionary:{},context_dictionaryToCreate:{},context_data:[],context_c:"",context_wc:"",context_w:"",context_enlargeIn:2,context_dictSize:3,context_numBits:2,context_data_val:0,context_data_position:0},o=0,r=0;r<t.length;r+=1)a.context_c=t.charAt(r),x(a.context_dictionary,a.context_c)||(a.context_dictionary[a.context_c]=a.context_dictSize++,a.context_dictionaryToCreate[a.context_c]=!0),a.context_wc=a.context_w+a.context_c,x(a.context_dictionary,a.context_wc)?a.context_w=a.context_wc:(B(a,n,e),a.context_dictionary[a.context_wc]=a.context_dictSize++,a.context_w=String(a.context_c));for(""!==a.context_w&&B(a,n,e),a.value=2,o=0;o<a.context_numBits;o++)a.context_data_val=a.context_data_val<<1|1&a.value,D(a,n,e),a.value=a.value>>1;for(;;){if(a.context_data_val=a.context_data_val<<1,a.context_data_position==n-1){a.context_data.push(e(a.context_data_val));break}a.context_data_position++}return a.context_data.join("")}(t,15,(function(t){return y(t+32)}))+" "}function L(t){return null==t?"":""===t?null:function(t,n,e){for(var a,o,r=[],c={val:e(0),position:n,index:1},i=[],u=4,s=4,f=3,l="",h=0;h<3;h++)r[h]=h;switch(R(c,Math.pow(2,2),n,e)){case 0:o=y(R(c,Math.pow(2,8),n,e));break;case 1:o=y(R(c,Math.pow(2,16),n,e));break;case 2:return""}for(r[3]=o,a=o,i.push(o);;){if(c.index>t)return"";switch(o=R(c,Math.pow(2,f),n,e)){case 0:r[s++]=y(R(c,Math.pow(2,8),n,e)),o=s-1,u--;break;case 1:r[s++]=y(R(c,Math.pow(2,16),n,e)),o=s-1,u--;break;case 2:return i.join("")}if(0===u&&(u=Math.pow(2,f),f++),r[o])l=r[o];else{if(o!==s)return null;l=a+a.charAt(0)}i.push(l),r[s++]=a+l.charAt(0),a=l,0==--u&&(u=Math.pow(2,f),f++)}}(t.length,16384,(function(n){return t.charCodeAt(n)-32}))}function U(){try{return sessionStorage.setItem("testKey","testValue"),sessionStorage.removeItem("testKey"),!0}catch(t){return!1}}function q(t,n){return U()?sessionStorage.setItem(t,$(u(n)?JSON.stringify(n):n)):function(t,n){if(t&&void 0!==n){var e=g.hostname,o="https:"===g.protocol,r=n;u(n)&&(r=JSON.stringify(n));var i=-1===a.indexOf(e)?"; domain=".concat(c(e)):"",s=o?"; secure":"";document.cookie="".concat(t," = ").concat(r).concat(i).concat("; path=/").concat(s)}}(t,n)}function z(t){if(U()){var n=L(sessionStorage.getItem(t));try{return n=JSON.parse(n)}catch(t){return n}}return function(t){if(t){var n=decodeURIComponent(document.cookie),e="";return function(t,n){if(t&&t.length)for(var e=0;e<t.length;e+=1)if("function"==typeof n){var a=n.apply(t,[t[e],e]);if("boolean"==typeof a){if(a)continue;break}}}(n.split(";"),(function(n){var a="".concat(t,"="),o=n.indexOf(a);if(o>-1)return e=c(n.substring(o+a.length,n.length)),!1})),e}return""}(t)}var H={set:function(){return q.apply(this,arguments)},get:function(){return z.apply(this,arguments)}};function J(){this.handlers=[]}T(J.prototype,{getDataFromStore:function(t,n){return T(H.get("routeStore"))["".concat(n?"#":"").concat(t)]},setDataToStore:function(t,n,e){var a=T(H.get("routeStore"));if(a[t]&&(!e||s(e)&&0===_(e).length))return!1;var o={};return o["".concat(n?"#":"").concat(t)]=e,a=T({},a,o),H.set("routeStore",a)},contains:function(t){return!!this.handlers.filter(t).length},remove:function(t){this.handlers.splice(this.handlers.indexOf(t),1).length}});var P=new J;function F(){var t=g.hash.match(e);return T({},N(),t?T({},N(t[0])):{})}function K(t,n,e){var a=p(n),o=(n=n.substring(+a)).split("?")[0];_(e=T(e)).length&&P.setDataToStore(o,a,e);var r=m(t,n);return{hasMatch:_(r).length>0||h(n)&&(t===n||"*"===t),data:P.getDataFromStore(o,a),params:r}}function Q(t){t.type=t.hash?"hashchange":"popstate";var n=f(t.originalData,{});t.originalEvent=f(t.originalEvent,d(t.type,n)),delete t.originalData,function(t,n,e){e=T(e),P.handlers.forEach((function(a){if(a.eventName===t){var o=g[n.hash?"hash":"pathname"],r=K(a.isCaseInsensitive?a.route.toLowerCase():a.route,a.isCaseInsensitive?o.toLowerCase():o,e);r.hasMatch&&(!a.hash||a.hash&&n.hash)&&a.handler(T({},n,{data:r.data,params:r.params,query:F()}))}}))}("route.changed",t,n)}function V(t,n,e){var a=T({replaceMode:n,noTrigger:e},"string"==typeof t?{route:t}:t);if("string"==typeof a.route){var o=p(a.route),r=c(a.route).split("?"),i=r[0].substring(+o),u=b(c(r[1])||c(a.queryString));if(!h(i))throw new TypeError("Route string is not a pure route");P.setDataToStore(i,o,a.data);var s=function(t,n,e,a){e=c(e.substring(+("?"===e.charAt(0))));var o=a?g.search:"";return n?"".concat(g.pathname).concat(o,"#").concat(t).concat(e?"?".concat(e):""):"".concat(t).concat(o).concat(e?"".concat(o?"&":"?").concat(e):"")}(i,o,u,a.appendQuery);history[a.replaceMode?"replaceState":"pushState"]({data:a.data},a.title,s),a.noTrigger||Q({route:"".concat(o?"#":"").concat(i),hash:o})}}function G(t,n,e){var a="string"==typeof t&&0===t.indexOf("$$");if(v(t)&&(e=n,n=t,t="*"),r(t))return function(t,n){var e=this;P.contains((function(t){return t.prevHandler===n}))||G((function(a){v(n)&&t.indexOf("".concat(a.hash?"#":"").concat(a.route.substring(+a.hash)))>-1&&n.apply(e,[a])}),n)}(t,n);var o=p(t=t.substring(a?"$$".length:0));t=t.substring(+o),!P.contains((function(e){return e.handler===n&&e.route===t}))&&v(n)&&P.handlers.push({eventName:"route.changed",handler:n,prevHandler:e,route:t,hash:o,isCaseInsensitive:a}),(o?[g.hash]:[g.pathname,g.hash]).filter((function(t){return c(t)})).forEach((function(e){var o=p(e),r=K(a?t.toLowerCase():t,a?e.toLowerCase():e);if(r.hasMatch&&v(n)){var c=o?"hashchange":"popstate";n({originalEvent:d(c,r.data),route:e,hash:o,eventName:c,data:r.data,params:r.params,query:F(),isCaseInsensitive:a})}}))}function W(t,n){var e=P.handlers.length,a=r(t);if(a&&!n)return 0;var o=l(arguments);return 0===o.length?(P.handlers.length=0,e):(t=a?"*":t,P.handlers.forEach((function(e){var r=e.route===t,c=1===o.length;c&&"string"==typeof t&&!a||(c&&v(t)&&(n=t,t="*"),r=r&&(e.handler===n||e.prevHandler===n)),r&&P.remove(e)})),e-P.handlers.length)}function X(t,n){if(n=c(n),!Array.isArray(t))throw new TypeError("Provide a valid list of routes");for(var e=!1,a=0;a<t.length;a++){var o=c(t[a]);if(["*",n].indexOf(o)>-1||Object.keys(m(o,n)).length){e=!0;break}}return e}var Y={set:function(){return V.apply(this,arguments)},includes:function(){return X.apply(this,arguments)},list:function(){var t=[];return P.handlers.forEach((function(n){var e="".concat(n.hash?"#":"").concat(n.route);-1===t.indexOf(e)&&t.push(e)})),t}};function Z(){return G.apply(this,arguments)}function tt(t){"string"==typeof t&&Z.apply(this,["".concat("$$").concat(t),l(arguments).slice(1)])}function nt(){return W.apply(this,arguments)}window.addEventListener("".concat("popstate"),(function(t){var n="".concat(g.pathname).concat(g.hash).split("#"),e={originalEvent:t,originalData:T(t.state&&t.state.data)};Q(T({},e,{route:n[0],hash:!1})),n[1]&&Q(T({},e,{route:"#".concat(n[1]),hash:!0}))}));export{N as deparam,b as param,Z as route,tt as routeIgnoreCase,m as routeParams,Y as router,nt as unroute};
